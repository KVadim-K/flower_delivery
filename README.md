# Flower Delivery

## Описание проекта
Flower Delivery - это онлайн-платформа для продажи цветов с возможностью добавления в корзину, оформления заказа и оставления отзывов. Также проект включает административные и пользовательские Telegram-боты, которые уведомляют о заказах, а также поддерживают функции управления заказами и аналитики.

## Установка

### Зависимости
Убедитесь, что у вас установлен Python (рекомендуется версия 3.8+). Все зависимости перечислены в `requirements.txt`. 
Установите их с помощью следующей команды:

```bash
pip install -r requirements.txt
```

1. Настройка окружения
Создайте файл .env в папке telegram_bot и добавьте следующие переменные:

- BOT_TOKEN — токен основного Telegram-бота.
- API_URL — URL API.
- SITE_URL — URL сайта.
- TELEGRAM_IDS — идентификаторы Telegram-пользователей для уведомлений.
- ADMIN_BOT_TOKEN — токен админ-бота.
- ADMIN_TELEGRAM_IDS — идентификаторы администраторов для уведомлений.
- ADMIN_API_TOKEN — токен для доступа к административному API.
2. Настройте Redis для работы на порту 6380 либо на порту 6379 и укажите следующие параметры в settings.py для Celery:

```python
CELERY_BROKER_URL = 'redis://localhost:6380/0'
CELERY_RESULT_BACKEND = 'redis://localhost:6380/0'
```

## Запуск проекта

### Запуск сервера Django
Для запуска основного сервера выполните команду:

```bash
python manage.py runserver
```

## Настройка для работы с Celery и Redis
Для запуска Celery используйте следующую команду:

```bash
celery -A flower_delivery worker -l info -P solo
```

## Запуск ботов
Запустите telegram_bot и telegramadmin_bot, чтобы активировать уведомления и административные функции в Telegram. Подробности можно найти в telegram_bot/main.py и telegramadmin_bot/main.py.


```bash
python manage.py run_admin_bot
```

```bash
python telegram_bot/bot/main.py
```

## Использование
### Основные функции
- Корзина — добавляйте товары, просматривайте содержимое корзины, обновляйте и удаляйте позиции.
- Заказы — оформляйте заказы, просматривайте историю, повторяйте заказы.
- Отзывы — оставляйте отзывы на продукты, просматривайте существующие.
- Админ-панель — управление заказами и товарами, отчёты.

### Пользовательский бот
Основной Telegram-бот предоставляет пользователям следующие команды:

- /start — начать работу с ботом.
- /help — показать список доступных команд.
- /link <username> — связать Telegram аккаунт с учётной записью на сайте.
- /order — начать оформление нового заказа.
- /status <order_id> — узнать статус заказа по его ID.
- /clear — сброс текущего состояния бота.

### Административный бот
Администраторский Telegram-бот предоставляет следующие команды:

- /start — приветственное сообщение с инструкциями.
- /orders — список последних заказов.
- /order <id> — детали конкретного заказа.
- /changestatus <id> <status> — изменить статус заказа.
- /analytics — аналитика по заказам за последние 30 дней с графиками.


## Демонстрация проекта

![Flower Delivery](FlowerDelivery.gif)

Ознакомьтесь с функционалом проекта через наглядную демонстрацию!

## Демонстрация ботов

![Flower Delivery Bots](FlowerDeliveryBots.gif)

### API
Основные API-эндпоинты:

- POST /api/link_telegram_id/ - привязка Telegram ID к пользователю.
- api/orders/ - работа с заказами, включая создание, просмотр истории и обновление статуса.
- api/products/ - получение списка продуктов и поиск по названию.

### Структура проекта
- flower_delivery/ - основная директория Django-проекта.
    - cart/ - приложение для управления корзиной.
    - orders/ - приложение для управления заказами.
    - products/ - приложение для работы с товарами.
    - reports/ - приложение для генерации отчётов.
    - reviews/ - приложение для работы с отзывами.
    - telegram_bot/ и telegramadmin_bot/ - боты для оставления и отслеживания заказов пользователями, уведомлений и администрирования.

### Серверная часть (Backend)
Проект построен на Django и включает:

- Django Rest Framework - для построения REST API.
- Celery - для асинхронных задач, таких как уведомления через ботов.
- Redis - в качестве брокера для Celery.

### Боты
Проект включает два Telegram-бота:

- Основной бот (telegram_bot) — для оставления и отслеживания заказов пользователей.
- Админ-бот (telegramadmin_bot) — для уведомлений и команд администратора.

Команды админ-бота:
- Уведомления о новых заказах.
- Возможность обновления статуса заказов.

### Аутентификация через социальные сети

Проект поддерживает возможность входа через социальные сети:

- Google
- GitHub
- VK

Для настройки аутентификации вам потребуется создать приложение в соответствующих сервисах и добавить ключи API в файл `.env`:

```env
SOCIAL_AUTH_GOOGLE_OAUTH2_KEY=ваш_google_client_id
SOCIAL_AUTH_GOOGLE_OAUTH2_SECRET=ваш_google_client_secret

SOCIAL_AUTH_GITHUB_KEY=ваш_github_client_id
SOCIAL_AUTH_GITHUB_SECRET=ваш_github_client_secret

SOCIAL_AUTH_VK_OAUTH2_KEY=ваш_vk_app_id
SOCIAL_AUTH_VK_OAUTH2_SECRET=ваш_vk_app_secret
```

### Тестирование
Для запуска тестов используйте команду:

```bash
python manage.py test --pattern="test_*.py"
```

### Авторские права и лицензия
Проект распространяется под лицензией MIT. Подробности в файле LICENSE.

## Портфолио

Вы можете ознакомиться с моим [портфолио](Портфолио_Final.pdf), чтобы узнать больше о моих проектах и опыте.


### Контакты
Для связи с авторами проекта или внесения предложений обратитесь по электронной KVadimK@yandex.ru.
Либо по телеграмм @KVadim_K
